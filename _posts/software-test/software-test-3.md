---
title: 【软件测试基础】- [3]黑盒测试用例设计方法
date: 2018-05-03 20:33:23
updated: 2018-05-03 20:33:23
tags: ['软件测试','黑盒测试','用例设计','等价类划分', '边界值', '错误推测', '因果图', '判定表', '正交试验', '功能图']
categories: 
 - 软件测试
---

从理论上讲，黑盒测试只有采用穷举输入测试，把所有可能的输入都作为测试情况考虑，才能查出程序中所有的错误。实际上测试情况有无穷多个，人们不仅要测试所有合法的输入，而且还要对那些不合法但可能的输入进行测试。这样看来，完全测试是不可能的，所以我们要进行有针对性的测试，通过制定测试案例指导测试的实施，保证软件测试有组织、按步骤，以及有计划地进行。黑盒测试行为必须能够加以量化，才能真正保证软件质量，而测试用例就是将测试行为具体量化的方法之一。

黑盒测试用例设计方法包括`等价类划分法`、`边界值分析法`、`错误推测法`、`因果图法`、`判定表驱动法`、`正交试验设计法`、`功能图法`、`场景法`等。

# 等价类划分

等价类划分的办法是把程序的输入域划分成若干部分（子集），然后从每个部分中选取少数代表性数据作为测试用例。每一类的代表性数据在测试中的作用等价于这一类中的其他值。该方法是一种重要的，常用的黑盒测试用例设计方法。

## 划分等价类

等价类是指某个输入域的子集合。在该子集合中，各个输入数据对于揭露程序中的错误都是等效的，并合理地假定：测试某等价类的代表值就等于对这一类其它值的测试。因此，可以把全部输入数据合理划分为若干等价类，在每一个等价类中取一个数据作为测试的输入条件，就可以用少量代表性的测试数据。取得较好的测试结果。

等价类划分可有两种不同的情况：有效等价类和无效等价类。

### 有效等价类

指对于程序的规格说明来说是合理的，有意义的输入数据构成的集合。利用有效等价类可检验程序是否实现了规格说明中所规定的功能和性能。

### 无效等价类

与有效等价类的定义恰巧相反。

设计测试用例时，要同时考虑这两种等价类。因为，软件不仅要能接收合理的数据，也要能经受意外的考验。这样的测试才能确保软件具有更高的可靠性。

## 划分方法

下面给出六条确定等价类的原则：

 1. 在输入条件规定了取值范围或值的个数的情况下，则可以确立一个有效等价类和两个无效等价类。
 2. 输入条件规定了输入值的集合或者规定了“必须如何”的条件的情况下，可确立一个有效等价类和一个无效等价类。
 3. 在输入条件是一个布尔量的情况下，可确定一个有效等价类和一个无效等价类。
 4. 在规定了输入数据的一组值（假定n个），并且程序要对每一个输入值分别处理的情况下，可确立n个有效等价类和一个无效等价类。
 5. 在规定了输入数据必须遵守的规则的情况下，可确立一个有效等价类（符合规则）和若干个无效等价类（从不同角度违反规则）。
 6. 在确知已划分的等价类中各元素在程序处理中的方式不同的情况下，则应再将该等价类进一步的划分为更小的等价类。

## 设计测试用例

在确立了等价类后，可建立等价类表，列出所有划分出的等价类：

|输入条件|有效等价类|无效等价类|
|---|---|---|

---

然后从划分出的等价类中按以下三个原则设计测试用例：

 1. 为每一个等价类规定一个唯一的编号。
 2. 设计一个新的测试用例，使其尽可能多地覆盖尚未被覆盖地有效等价类，重复这一步。直到所有的有效等价类都被覆盖为止。
 3. 设计一个新的测试用例，使其仅覆盖一个尚未被覆盖的无效等价类，重复这一步。直到所有的无效等价类都被覆盖为止。

# 边界值分析法

边界值分析是通过选择等价类边界的测试用例。边界值分析法不仅重视输入条件边界，而且也必须考虑输出域边界。它是对等价类划分方法的补充。

## 边界值分析方法的考虑

长期的测试工作经验告诉我们，大量的错误是发生在输入或输出范围的边界上，而不是发生在输入输出范围的内部。因此针对各种边界情况设计测试用例，可以查出更多的错误。

使用边界值分析方法设计测试用例，首先应确定边界情况。通常输入和输出等价类的边界，就是应着重测试的边界情况。应当选取正好等于，刚刚大于或刚刚小于边界的值作为测试数据，而不是选取等价类中的典型值或任意值作为测试数据。

## 原则

 1. 如果输入条件规定了值的范围，则应取刚达到这个范围的边界的值，以及刚刚超越这个范围边界的值作为测试输入数据。
 2. 如果输入条件规定了值的个数，则用最大个数,最小个数，比最小个数少一，比最大个数多一的数作为测试数据。
 3. 根据规格说明的每个输出条件，使用前面的原则1）。
 4. 根据规格说明的每个输出条件，应用前面的原则2）。
 5. 如果程序的规格说明给出的输入域或输出域是有序集合，则应选取集合的第一个元素和最后一个元素作为测试用例。
 6. 如果程序中使用了一个内部数据结构，则应当选择这个内部数据结构的边界上的值作为测试用例。
 7. 分析规格说明，找出其它可能的边界条件。

# 错误推测法

错误推测法是基于经验和直觉推测程序中所有可能存在的各种错误，从而有针对性的设计测试用例的方法。

## 基本思想

列举出程序中所有可能有的错误和容易发生错误的特殊情况，根据他们选择测试用例。 

例如：
 - 在单元测试时曾列出的许多在模块中常见的错误
 - 以前产品测试中曾经发现的错误
 - 输入数据和输出数据为0的情况
 - 输入表格为空格或输入表格只有一行

# 因果图法

前面介绍的等价类划分方法和边界值分析方法，都是着重考虑输入条件，但未考虑输入条件之间的联系，相互组合等。 考虑输入条件之间的相互组合，可能会产生一些新的情况。但要检查输入条件的组合不是一件容易的事情，即使把所有输入条件划分成等价类，他们之间的组合情况也相当多。因此必须考虑采用一种适合于描述对于多种条件的组合，相应产生多个动作的形式来考虑设计测试用例。这就需要利用因果图（逻辑模型）。

因果图方法最终生成的就是`判定表`。它适合于检查程序输入条件的各种组合情况。

## 生成测试用例

1. 分析软件规格说明描述中，哪些是原因（即输入条件或输入条件的等价类），哪些是结果（即输出条件），并给每个原因和结果赋予一个标识符。
2. 分析软件规格说明描述中的语义。找出原因与结果之间，原因与原因之间对应的关系。根据这些关系，画出因果图。
3. 由于语法或环境限制，有些原因与原因之间，原因与结果之间的组合情况不可能出现。为表明这些特殊情况，在因果图上用一些记号标明约束或限制条件。
4. 把因果图转换为判定表。
5. 把判定表的每一列拿出来作为依据，设计测试用例。

从因果图生成的测试用例（局部，组合关系下的）包括了所有输入数据的取TRUE与取FALSE的情况，构成的测试用例数目达到最少，且测试用例数目随输入数据数目的增加而线性地增加。

# 判定表

前面因果图方法中已经用到了判定表。判定表（Decision Table）是分析和表达多逻辑条件下执行不同操作的情况下的工具。在程序设计发展的初期，判定表就已被当作编写程序的辅助工具了。由于它可以把复杂的逻辑关系和多种条件组合的情况表达得既具体又明确。

## 判定表组成

条件桩（Condition Stub）：列出了问题的所有条件。通常认为列出的条件的次序无关紧要。
动作桩（Action Stub）：列出了问题规定可能采取的操作。这些操作的排列顺序没有约束。
条件项（Condition Entry）：列出针对它左列条件的取值。在所有可能情况下的真假值。
动作项（Action Entry）：列出在条件项的各种取值情况下应该采取的动作。

## 规则

任何一个条件组合的特定取值及其相应要执行的操作。在判定表中贯穿条件项和动作项的一列就是一条规则。显然，判定表中列出多少组条件取值，也就有多少条规则，既条件项和动作项有多少列。

## 判定表的建立步骤

1. 确定规则的个数。假如有n个条件。每个条件有两个取值（0,1），故有2n种规则。
2. 列出所有的条件桩和动作桩。
3. 填入条件项。
4. 填入动作项。等到初始判定表。
5. 简化合并相似规则（相同动作）。

## 适合使用判定表的条件

1. 规格说明以判定表形式给出，或很容易转换成判定表。
2. 条件的排列顺序不会也不影响执行哪些操作。
3. 规则的排列顺序不会也不影响执行哪些操作。
4. 每当某一规则的条件已经满足，并确定要执行的操作后，不必检验别的规则。
5. 如果某一规则得到满足要执行多个操作，这些操作的执行顺序无关紧要。

# 正交试验

## 概念

在一项试验中 ,把影响试验结果的量称为试验因素 ,简称因素。 因素可以理解为试验过程中的自变量 ,试验结果可以看成因素的函数。 在试验过程中 ,每一个因素可以处于不同的状态或状况 ,把因素所处的状态或状况 ,称为因素的水平 ,简称水平 。

正交试验设计是利用正交表来安排与分析多因素试验的一种设计方法。 它是由试验因素的全部水平组合中 ,挑选部分有代表性的水平组合进行试验的 ,通过对这部分试验结果的分析了解全面试验的情况 ,找出最优的水平组合。

## 特点

用部分试验来代替全面试验 ,通过对部分试验结果的分析 ,了解全面试验的情况。

## 设计测试用例的步骤

### 确定因素

这里的因素是指对软件运行结果有影响的软件运行条件。

### 确定因素的取值范围或集合

因素的取值范围是指软件输入的取值范围或集合以及可用的硬件资源。

### 确定每个因素的水平

根据因素的取值范围或集合 ,采用等价类划分、边界值分析以及其他软件测试技术 ,在每个因素的取值范围或集合内挑选出有效等价类、无效等价类、正好等于、刚刚大于或刚刚小于边界值等有代表性的测试点。

### 选择正交表

根据确定的因素和水平 ,选择适合的正交表。如果没有合适的正交表可用或需要的测试用例个数太多 ,要对因素和水平进行调整。

### 设计测试用例

将所确定的因素与正交表中的“列”号对应 ,所确定的水平与正交表中的数码数对应 ,填写正交表。若要对结果进行分析 ,该表还要包括其他的行和列。如响应时间、平均响应时间、极差等。 除此之外 ,还要增加“期望值”等列。

### 测试结果分析

根据测试需要 ,采用极差或方差分析法对测试数据进行分析 ,找出对测试指标影响最大的因素以及最佳的因素水平组合 。

利用正交实验设计方法设计测试用例，比使用等价类划分，边界值分析，因果图等方法有以下优点：节省测试工作工时；可控制生成的测试用例数量；测试用例具有一定的覆盖率。

# 场景法

软件几乎都是用事件触发来控制流程的，事件触发的情景便形成了场景，而同一事件不同的触发顺序和处理结果就形成事件流。这种在软件设计方面的思想也可以引入到软件测试中，可以比较生动地描绘出事件触发时的情景，有利于测试设计者设计测试用例，同时使测试用例更容易理解和执行。

基本流和备选流：如下图所示

![这里写图片描述](https://img-blog.csdn.net/20180503203126085)

图中经过用例的每条路径都用基本流和备选流来表示，直黑线表示基本流，是经过用例的最简单的路径。备选流用不同的色彩表示，一个备选流可能从基本流开始，在某个特定条件下执行，然后重新加入基本流中（如备选流1和3）；也可能起源于另一个备选流（如备选流2），或者终止用例而不再重新加入到某个流（如备选流2和4）。
